<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:context="http://www.springframework.org/schema/context"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xmlns:int="http://www.springframework.org/schema/integration"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration.xsd">


	<int:channel id="httpInput"/>
	
	<int:json-to-object-transformer 
		input-channel="httpInput" 
		output-channel="elevatorRequest"
    	type="io.github.u2ware.xd.netty.HyundaiElevatorRequest"/>

	<int:channel id="elevatorRequest">
		<int:queue/>
	</int:channel>
	
	<bean id="elevator2" class="io.github.u2ware.xd.netty.HyundaiElevatorChannelAdapter">
		<property name="host" value="127.0.0.1"/>
		<property name="port" value="10921"/>
		<property name="idleTimeout" value="0"/>

		<property name="sendChannel" ref="elevatorResponse"/>
		<property name="receiveChannel" ref="elevatorRequest"/>
	</bean>
	
	<int:channel id="elevatorResponse">
		<int:queue/>
	</int:channel>
	
	<int:object-to-json-transformer 
		input-channel="elevatorResponse"
		output-channel="httpOutput" 
		content-type="application/json">
		<int:poller fixed-rate="100"/>
	</int:object-to-json-transformer>
	
	<int:channel id="httpOutput">
		<int:queue/>
	</int:channel>

	<bean id="elevatorHttp" class="io.github.u2ware.integration.netty.support.HttpMessageChannelAdapter">
		<property name="port" value="10930"/>
		<property name="messagingTimeout" value="60000"/>
		<property name="sendChannel" ref="httpInput"/>
		<property name="receiveChannel" ref="httpOutput"/>
	</bean>
	
	
	
</beans>